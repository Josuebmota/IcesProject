<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfólio - Igreja Cristã Evangélica Sobral</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/apexcharts/3.28.3/apexcharts.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pptxgenjs/3.4.0/pptxgen.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f9;
            color: #333;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #4a90e2;
            color: white;
            padding: 20px;
            text-align: center;
        }
        .logo {
            width: 80%;
            max-width: 300px;
            height: auto;
            display: block;
            margin: 0 auto;
        }
        #charts {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* Duas colunas por linha */
            grid-gap: 20px;
            margin: 20px;
            padding: 0 10px;
        }
        .chart-container {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            padding: 20px;
            text-align: center;
        }
        .chart-title {
            margin-top: 10px;
            font-size: 1.2em;
            color: #4a90e2;
        }
        .preletor-img {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            margin: 10px auto;
        }
        .objetivos {
            margin-top: 15px;
            font-style: italic;
            color: #555;
        }
        .insights {
            margin-top: 40px;
            padding: 20px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
            margin: 20px;
        }
        .insights h2 {
            color: #4a90e2;
        }
        .insights ul {
            list-style-type: disc;
            padding-left: 20px;
        }
        #download-ppt {
            display: block;
            margin: 20px auto;
            padding: 10px 20px;
            background-color: #4a90e2;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
        }
        @media (max-width: 800px) {
            #charts {
                grid-template-columns: 1fr; /* Uma coluna em telas menores */
            }
        }
    </style>
</head>
<body>
    <header>
        <img src="img/ices.png" alt="Logo Igreja Cristã Evangélica Sobral" class="logo">
        <h1>Igreja Cristã Evangélica Sobral</h1>
    </header>

    <button id="download-ppt">Download PowerPoint</button>

    <div id="charts">
        <div class="chart-container">
            <div id="chart-geral"></div>
            <div class="chart-title">Assiduidade Geral</div>
            <img src="img/logo.png" alt="Geral" class="preletor-img">
            <div class="objetivos">Objetivos gerais: Fomentar o Relacionamento profundo entre os membros antigos e novos</div>
        </div>
        <div class="chart-container">
            <div id="chart-rapazes"></div>
            <div class="chart-title">Rapazes - Pastor Miguel</div>
            <img src="img/miguel.png" alt="Pastor Miguel" class="preletor-img">
            <div class="objetivos">Objetivos: Formar rapazes intelectualmente equipados, com caráter provado e com habilidades úteis para a edificação da igreja e para seu crescimento pessoal</div>
        </div>
        <div class="chart-container">
            <div id="chart-homens"></div>
            <div class="chart-title">Homens - Jociell</div>
            <img src="img/Jociel.png" alt="Jociell" class="preletor-img">
            <div class="objetivos">Objetivos: Desenvolver homens com o caráter semelhantes a Jesus para a glória de Deus</div>
        </div>
        <div class="chart-container">
            <div id="chart-mocas"></div>
            <div class="chart-title">Moças - Milca</div>
            <img src="img/milca.png" alt="Milca" class="preletor-img">
            <div class="objetivos">Objetivos: Ajudar meninas a se desenvolverem em assuntos cruciais da vida comum mediante uma cosmovisão Cristã</div>
        </div>
        <div class="chart-container">
            <div id="chart-mulheres"></div>
            <div class="chart-title">Mulheres - Rafaela</div>
            <img src="img/rafa.png" alt="Rafaela" class="preletor-img">
            <div class="objetivos">Objetivos: Formar o caráter de Cristo em cada mulher para que Deus seja mais glorificado</div>
        </div>
        <div class="chart-container">
            <div id="chart-cfc"></div>
            <div class="chart-title">CFC - Pastor Álefe</div>
            <img src="img/alefe.png" alt="Pastor Álefe" class="preletor-img">
            <div class="objetivos">Objetivos: Apresentar o evangelho de modo simples e panorâmico aos interessados na fé cristã, aos que pretendem ser batizados e aos que foram batizados há pouco tempo.</div>
        </div>
    </div>

    <div class="insights">
        <h2>Estratégias para Aumentar a Assiduidade</h2>
        <ul>
            <li><strong>Comunicação Consistente:</strong> Implementar um sistema de comunicação eficaz que utilize ferramentas digitais para enviar lembretes e resumos das aulas. Isso garantirá que os participantes estejam sempre informados e engajados, promovendo um ambiente de aprendizagem mais ativo e participativo.</li>
            <li><strong>Reconhecimento e Incentivos:</strong> Desenvolver um programa de reconhecimento para premiar alunos com alta frequência, como a concessão de certificados de mérito ou menções honrosas. Esse tipo de incentivo pode motivar os estudantes a manterem sua participação constante.</li>
            <li><strong>Dinâmica Interativa nas Aulas:</strong> Incorporar atividades que incentivem a interação, como debates em grupo e estudos de caso práticos. Essas abordagens tornam o processo de aprendizagem mais atraente e envolvente, estimulando a curiosidade e o interesse contínuo dos alunos.</li>
            <li><strong>Ajuste na Flexibilidade de Horários:</strong> Avaliar a possibilidade de ajustar os horários das aulas em função da disponibilidade dos alunos. Essa flexibilidade pode facilitar a participação, especialmente para aqueles com compromissos concorrentes.</li>
            <li><strong>Processo de Feedback Constante:</strong> Estabelecer um mecanismo regular de coleta de feedback dos alunos sobre o conteúdo e a dinâmica das aulas. Utilizar este feedback para realizar ajustes necessários, assegurando que as aulas atendam às expectativas e necessidades dos participantes.</li>
            <li><strong>Análise de Assiduidade por Salas:</strong> Realizar uma avaliação detalhada das salas de aula para identificar quais delas apresentam os maiores índices de assiduidade, permitindo uma análise de fatores que contribuem para este sucesso.</li>
            <li><strong>Reconhecimento de Alunos Dedicados:</strong> Destacar e celebrar os alunos que mantêm uma frequência impecável, participando de todas as aulas. Esse reconhecimento não apenas motiva os alunos envolvidos, mas também incentiva outros a seguirem o exemplo.</li>
        </ul>
    </div>

    <script>
        document.getElementById('download-ppt').addEventListener('click', function() {
            let pptx = new PptxGenJS();
            
            let slide1 = pptx.addSlide();
            slide1.addText('Assiduidade Geral', { x: 0.5, y: 0.5, fontSize: 24, color: '003366' });
            slide1.addText('Objetivos gerais: Fomentar o Relacionamento profundo entre os membros antigos e novos', { x: 0.5, y: 1, fontSize: 14, color: '666666' });

            let slide2 = pptx.addSlide();
            slide2.addText('Rapazes - Pastor Miguel', { x: 0.5, y: 0.5, fontSize: 24, color: '003366' });
            slide2.addText('Objetivos: Formar rapazes intelectualmente equipados, com caráter provado e com habilidades úteis para a edificação da igreja e para seu crescimento pessoal', { x: 0.5, y: 1, fontSize: 14, color: '666666' });

            // Adicione mais slides conforme necessário
            pptx.writeFile('Apresentacao_Igreja.pptx');
        });

        const temasPorSala = {
            "Rapazes": [
                "O que é o evangelho",
                "Vida devocional",
                "O que é santidade",
                "Estudando para a glória de Deus",
                "Trabalho e finanças à luz da Bíblia",
                "Qual o meu ministério",
                "Tornando-se um líder cristão",
                "Relacionamentos à luz da Bíblia"
            ],
            "Homens": [
                "Masculinidade",
                "Teologia do trabalho",
                "Liderança",
                "Finanças",
                "Relacionamento conjugal",
                "Pureza sexual",
                "Criação de filhos",
                "Amizade discipuladora"
            ],
            "Mocas": [
                "Quem é Deus",
                "O que é o pecado",
                "Quem Jesus é o que Ele fez",
                "Qual a resposta a dar",
                "O que é a igreja",
                "Quais são os sacramentos",
                "O primeiro e o ultimo sacrifício",
                "Compartilhando o meu testemunho"
            ],
            "Mulheres": [
                "Teologia e sabedoria",
                "Administração do tempo",
                "Gerenciamento de emoções",
                "Administração do lar",
                "Submissão à luz da Bíblia",
                "Sexualidade santa",
                "Fertilidade",
                "Discipulando os filhos"
            ],
            "CFC": [
                "Quem é Deus",
                "O que é o pecado",
                "Quem Jesus é o que Ele fez",
                "Qual a resposta a dar",
                "O que é a igreja",
                "Quais são os sacramentos",
                "O primeiro e o ultimo sacrifício",
                "Compartilhando o meu testemunho"
            ]
        };

        const dadosAulas = [
            {
                data: "15.09.2024",
                totalMatriculas: 88,
                totalPresentes: 83,
                visitantes: 20,
                salas: [
                    { nome: "Rapazes", tema: temasPorSala["Rapazes"][0], matriculados: 13, presentesMatriculados: 9, faltas: 4, visitantes: 8, totalPresentes: 17 },
                    { nome: "Homens", tema: temasPorSala["Homens"][0], matriculados: 19, presentesMatriculados: 12, faltas: 7, visitantes: 1, totalPresentes: 15 },
                    { nome: "Mocas", tema: temasPorSala["Mocas"][0], matriculados: 11, presentesMatriculados: 8, faltas: 3, visitantes: 2, totalPresentes: 11 },
                    { nome: "Mulheres", tema: temasPorSala["Mulheres"][0], matriculados: 30, presentesMatriculados: 22, faltas: 8, visitantes: 9, totalPresentes: 32 },
                    { nome: "CFC", tema: temasPorSala["CFC"][0], matriculados: 15, presentesMatriculados: 6, faltas: 9, visitantes: 0, totalPresentes: 8 }
                ]
            },
            {
                data: "22.09.2024",
                totalMatriculas: 97,
                totalPresentes: 93,
                visitantes: 15,
                salas: [
                    { nome: "Rapazes", tema: temasPorSala["Rapazes"][1], matriculados: 20, presentesMatriculados: 16, faltas: 4, visitantes: 4, totalPresentes: 20 },
                    { nome: "Homens", tema: temasPorSala["Homens"][1], matriculados: 20, presentesMatriculados: 16, faltas: 4, visitantes: 2, totalPresentes: 19 },
                    { nome: "Mocas", tema: temasPorSala["Mocas"][1], matriculados: 11, presentesMatriculados: 10, faltas: 1, visitantes: 2, totalPresentes: 13 },
                    { nome: "Mulheres", tema: temasPorSala["Mulheres"][1], matriculados: 30, presentesMatriculados: 22, faltas: 8, visitantes: 7, totalPresentes: 30 },
                    { nome: "CFC", tema: temasPorSala["CFC"][1], matriculados: 16, presentesMatriculados: 8, faltas: 10, visitantes: 0, totalPresentes: 11 }
                ]
            },
            {
                data: "29.09.2024",
                totalMatriculas: 102,
                totalPresentes: 65,
                visitantes: 13,
                salas: [
                    { nome: "Rapazes", tema: temasPorSala["Rapazes"][2], matriculados: 23, presentesMatriculados: 14, faltas: 9, visitantes: 4, totalPresentes: 18 },
                    { nome: "Homens", tema: temasPorSala["Homens"][2], matriculados: 20, presentesMatriculados: 10, faltas: 10, visitantes: 1, totalPresentes: 11 },
                    { nome: "Mocas", tema: temasPorSala["Mocas"][2], matriculados: 11, presentesMatriculados: 4, faltas: 7, visitantes: 2, totalPresentes: 7 },
                    { nome: "Mulheres", tema: temasPorSala["Mulheres"][2], matriculados: 30, presentesMatriculados: 22, faltas: 8, visitantes: 7, totalPresentes: 30 },
                    { nome: "CFC", tema: temasPorSala["CFC"][2], matriculados: 18, presentesMatriculados: 2, faltas: 16, visitantes: 0, totalPresentes: 3 }
                ]
            },
            {
                data: "06.10.2024", // Aula 4 com dados zerados
                totalMatriculas: 0,
                totalPresentes: 0,
                visitantes: 0,
                salas: [
                    { nome: "Rapazes", tema: temasPorSala["Rapazes"][3], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 },
                    { nome: "Homens", tema: temasPorSala["Homens"][3], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 },
                    { nome: "Mocas", tema: temasPorSala["Mocas"][3], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 },
                    { nome: "Mulheres", tema: temasPorSala["Mulheres"][3], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 },
                    { nome: "CFC", tema: temasPorSala["CFC"][3], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 }
                ]
            },
            {
                data: "13.10.2024", // Aula 5 com dados zerados
                totalMatriculas: 0,
                totalPresentes: 0,
                visitantes: 0,
                salas: [
                    { nome: "Rapazes", tema: temasPorSala["Rapazes"][4], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 },
                    { nome: "Homens", tema: temasPorSala["Homens"][4], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 },
                    { nome: "Mocas", tema: temasPorSala["Mocas"][4], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 },
                    { nome: "Mulheres", tema: temasPorSala["Mulheres"][4], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 },
                    { nome: "CFC", tema: temasPorSala["CFC"][4], matriculados: 0, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 }
                ]
            },
            {
                data: "10.11.2024",
                totalMatriculas: 111,
                totalPresentes: 59,
                visitantes: 9,
                salas: [
                    { nome: "Rapazes", tema: temasPorSala["Rapazes"][5], matriculados: 27, presentesMatriculados: 9, faltas: 18, visitantes: 1, totalPresentes: 10 },
                    { nome: "Homens", tema: temasPorSala["Homens"][5], matriculados: 21, presentesMatriculados: 11, faltas: 10, visitantes: 3, totalPresentes: 15 },
                    { nome: "Mocas", tema: temasPorSala["Mocas"][5], matriculados: 14, presentesMatriculados: 4, faltas: 10, visitantes: 3, totalPresentes: 8 },
                    { nome: "Mulheres", tema: temasPorSala["Mulheres"][5], matriculados: 31, presentesMatriculados: 19, faltas: 11, visitantes: 2, totalPresentes: 22 },
                    { nome: "CFC", tema: temasPorSala["CFC"][5], matriculados: 18, presentesMatriculados: 3, faltas: 15, visitantes: 0, totalPresentes: 4 }
                ]
            },
            {
                data: "17.11.2024",
                totalMatriculas: 111,
                totalPresentes: 33,
                visitantes: 5,
                salas: [
                    { nome: "Rapazes", tema: temasPorSala["Rapazes"][6], matriculados: 27, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 }, // Aula adiada
                    { nome: "Homens", tema: temasPorSala["Homens"][6], matriculados: 21, presentesMatriculados: 7, faltas: 14, visitantes: 1, totalPresentes: 9 },
                    { nome: "Mocas", tema: temasPorSala["Mocas"][6], matriculados: 14, presentesMatriculados: 3, faltas: 11, visitantes: 1, totalPresentes: 5 },
                    { nome: "Mulheres", tema: temasPorSala["Mulheres"][6], matriculados: 31, presentesMatriculados: 11, faltas: 19, visitantes: 2, totalPresentes: 14 },
                    { nome: "CFC", tema: temasPorSala["CFC"][6], matriculados: 18, presentesMatriculados: 3, faltas: 15, visitantes: 1, totalPresentes: 5 }
                ]
            },
            {
                data: "24.11.2024",
                totalMatriculas: 111,
                totalPresentes: 34,
                visitantes: 11,
                salas: [
                    { nome: "Rapazes", tema: temasPorSala["Rapazes"][7], matriculados: 27, presentesMatriculados: 6, faltas: 21, visitantes: 1, totalPresentes: 7 },
                    { nome: "Homens", tema: temasPorSala["Homens"][7], matriculados: 21, presentesMatriculados: 12, faltas: 9, visitantes: 2, totalPresentes: 15 },
                    { nome: "Mocas", tema: temasPorSala["Mocas"][7], matriculados: 14, presentesMatriculados: 0, faltas: 0, visitantes: 0, totalPresentes: 0 }, // Aula adiada
                    { nome: "Mulheres", tema: temasPorSala["Mulheres"][7], matriculados: 31, presentesMatriculados: 13, faltas: 17, visitantes: 8, totalPresentes: 22 },
                    { nome: "CFC", tema: temasPorSala["CFC"][7], matriculados: 18, presentesMatriculados: 3, faltas: 15, visitantes: 0, totalPresentes: 4 }
                ]
            }
        ];

        // Função para calcular o percentual de presença por sala, ignorando dados zerados
        function calcularPercentualSala(sala) {
            return sala.matriculados > 0 ? ((sala.totalPresentes - sala.visitantes) / sala.matriculados) * 100 : null;
        }

        // Função para configurar gráficos para cada sala
        function configurarGraficoSala(nomeSala, temas) {
            const dados = dadosAulas.map(aula => {
                const sala = aula.salas.find(s => s.nome === nomeSala);
                return sala ? calcularPercentualSala(sala) : null;
            });

            const options = {
                chart: {
                    type: 'line',
                    height: 350,
                    responsive: [{
                        breakpoint: 600,
                        options: {
                            chart: {
                                height: 250
                            },
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }]
                },
                series: [{
                    name: nomeSala,
                    data: dados
                }],
                xaxis: {
                    categories: temas,
                    labels: {
                        rotate: -45,
                        trim: true,
                        maxHeight: 60,
                        style: {
                            fontSize: '12px'
                        }
                    }
                },
                yaxis: {
                    min: 0,
                    max: 100,
                    tickAmount: 5,
                    labels: {
                        formatter: function (val) {
                            return val.toFixed(0) + "%";
                        }
                    }
                },
                dataLabels: {
                    enabled: true,
                    formatter: function (val) {
                        return val !== null ? val.toFixed(2) + "%" : "";
                    }
                },
                title: {
                    text: `Assiduidade - Sala ${nomeSala}`
                },
                tooltip: {
                    enabled: true,
                    y: {
                        formatter: function (val, { dataPointIndex }) {
                            const aula = dadosAulas[dataPointIndex];
                            const sala = aula.salas.find(s => s.nome === nomeSala);
                            if (!sala || sala.totalPresentes === 0) return "Aula não realizada";
                            return `Tema: ${sala.tema}<br>Total Matriculados: ${sala.matriculados}<br>Presentes Matriculados: ${sala.presentesMatriculados}<br>Faltas: ${sala.faltas}<br>Visitantes: ${sala.totalPresentes - sala.presentesMatriculados}<br>Total Presentes: ${sala.totalPresentes}`;
                        }
                    }
                },
                markers: {
                    size: 5,
                    colors: dados.map(val => val === null ? '#FF4560' : '#00E396'), // Marcações para dados zerados
                    strokeColors: '#fff',
                    strokeWidth: 2,
                    hover: {
                        size: 7
                    }
                }
            };

            return options;
        }

        // Renderizar gráficos para cada sala
        Object.keys(temasPorSala).forEach(nomeSala => {
            const chartElement = document.querySelector(`#chart-${nomeSala.toLowerCase()}`);
            if (chartElement) {
                const chart = new ApexCharts(chartElement, configurarGraficoSala(nomeSala, temasPorSala[nomeSala]));
                chart.render();
            }
        });

        // Função para calcular o percentual geral de presença
        function calcularPercentualGeral(aula) {
            return aula.totalMatriculas > 0 ? ((aula.totalPresentes - aula.visitantes) / aula.totalMatriculas) * 100 : null;
        }

        // Configuração para o Gráfico Geral
        const dadosGerais = dadosAulas.map(aula => calcularPercentualGeral(aula));

        var optionsGeral = {
            chart: {
                type: 'line',
                height: 350,
                responsive: [{
                    breakpoint: 600,
                    options: {
                        chart: {
                            height: 250
                        },
                        legend: {
                            position: 'bottom'
                        }
                    }
                }]
            },
            series: [{
                name: 'Geral',
                data: dadosGerais
            }],
            xaxis: {
                categories: dadosAulas.map((_, index) => `Tema ${index + 1}`),
                labels: {
                    rotate: -45,
                    trim: true,
                    maxHeight: 60,
                    style: {
                        fontSize: '12px'
                    }
                }
            },
            yaxis: {
                min: 0,
                max: 100,
                tickAmount: 5,
                labels: {
                    formatter: function (val) {
                        return val.toFixed(0) + "%";
                    }
                }
            },
            dataLabels: {
                enabled: true,
                formatter: function (val) {
                    return val !== null ? val.toFixed(2) + "%" : "";
                }
            },
            title: {
                text: 'Assiduidade Geral - Escola de Discípulos'
            },
            tooltip: {
                enabled: true,
                y: {
                    formatter: function (val, { dataPointIndex }) {
                        const aula = dadosAulas[dataPointIndex];
                        if (aula.totalPresentes === 0) return "Aula não realizada";
                        return `Total Presentes: ${aula.totalPresentes}<br>Visitantes: ${aula.visitantes}<br>Percentual: ${val.toFixed(2)}%`;
                    }
                }
            },
            markers: {
                size: 5,
                colors: dadosGerais.map(val => val === null ? '#FF4560' : '#00E396'), // Marcações para dados zerados
                strokeColors: '#fff',
                strokeWidth: 2,
                hover: {
                    size: 7
                }
            }
        };

        var chartGeral = new ApexCharts(document.querySelector("#chart-geral"), optionsGeral);
        chartGeral.render();
    </script>
</body>
</html>